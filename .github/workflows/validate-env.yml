name: ğŸ” Validate Environment Variables

on:
  workflow_call:
    inputs:
      required_vars:
        required: true
        type: string
        description: 'Comma-separated list of required environment variables'
      job_name:
        required: true
        type: string
        description: 'Name of the job for error messages'

jobs:
  validate:
    name: ğŸ” Validate Environment Variables
    runs-on: ubuntu-latest
    steps:
      - name: Check Required Variables
        run: |
          # Convert comma-separated list to array
          IFS=',' read -ra REQUIRED_VARS <<< "${{ inputs.required_vars }}"
          MISSING_VARS=()
          
          # Check each required variable
          for var in "${REQUIRED_VARS[@]}"; do
            # Check if the variable is set in environment
            if [[ -n "${!var}" ]]; then
              echo "âœ… $var is set in environment"
              continue
            fi
            
            # Variable is not set
            MISSING_VARS+=("$var")
          done
          
          if [ ${#MISSING_VARS[@]} -ne 0 ]; then
            echo "âŒ Missing required variables in ${{ inputs.job_name }} job:"
            for var in "${MISSING_VARS[@]}"; do
              echo "  - $var (not found in environment)"
            done
            exit 1
          else
            echo "âœ… All required variables are set in ${{ inputs.job_name }} job"
          fi 