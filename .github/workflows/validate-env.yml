name: ğŸ” Validate Environment Variables

on:
  workflow_call:
    inputs:
      required_vars:
        required: true
        type: string
        description: 'Comma-separated list of required environment variables'
      job_name:
        required: true
        type: string
        description: 'Name of the job for error messages'

jobs:
  validate:
    name: ğŸ” Validate Environment Variables
    runs-on: ubuntu-latest
    steps:
      - name: Check Required Variables
        run: |
          IFS=',' read -ra REQUIRED_VARS <<< "${{ inputs.required_vars }}"
          MISSING_VARS=()
          
          # Check each required variable
          for var in "${REQUIRED_VARS[@]}"; do
            # Use eval to check if the variable is set
            if ! eval "[ -n \"\$$var\" ]"; then
              MISSING_VARS+=("$var")
            fi
          done
          
          if [ ${#MISSING_VARS[@]} -ne 0 ]; then
            echo "âŒ Missing required environment variables in ${{ inputs.job_name }} job:"
            for var in "${MISSING_VARS[@]}"; do
              echo "  - $var"
            done
            exit 1
          else
            echo "âœ… All required environment variables are set in ${{ inputs.job_name }} job"
          fi 